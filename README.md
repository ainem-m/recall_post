
# Recall Post

## 概要

Recall Postは、患者データを管理し、郵送リコールサービス向けに処理を行うPythonベースのユーティリティです。このアプリケーションは主に患者のCSVファイルを処理し、関連情報を抽出して郵送サービスの要件に基づいてフォーマットします。小児患者の特定、最終来院日を基準とした患者のフィルタリング、指定されたNG（No Go）リストに記載された患者の除外が可能です。

---
## ディレクトリ構造

```text
.
├── result                 # 結果を出力するディレクトリ(実行時に作製)
├── README.md              # このファイル
├── .gitignore
├── config.py              # 設定ファイル (列名やファイルパスなど)
├── datetimeutil.py        # 日付や時刻の処理と変換に関するユーティリティ
├── dummy_patient_data.csv # テストや開発用のサンプルデータセット
├── launcher.py            # GUIランチャー
├── main.py                # データ処理のメインスクリプト
├── make_fake_list.py      # テスト用のダミー患者データを生成するスクリプト
├── nglist.csv             # NGリスト (患者IDによる除外対象)
├── postal_number.py       # 郵便番号や住所処理ユーティリティ
└── requirements.txt       # 必要なPythonライブラリ一覧
```


## 機能

- **データ処理**: CSV形式の患者データを読み取り、必要な列を検証
- **小児患者の識別**: 生年月日から年齢を計算し、小児患者を特定
- **郵送フォーマット**: 住所の詳細を郵送サービスと連携可能な形式に整形
- **NGリストフィルタリング**: 指定されたNGリストに記載された患者を除外
- **GUIランチャー**: 入力ファイルの選択や処理オプション設定を行うグラフィカルインターフェース

---

## インストール方法

1. **リポジトリをクローン**:
   ```bash
   git clone https://github.com/your-repo/recall_post.git
   cd recall_post
   ```

2. **依存関係をインストール**:
   Pythonがインストールされていることを確認し、以下を実行してください。
   ```bash
   pip install -r requirements.txt
   ```

---

## 使い方

### 1. GUIランチャーの実行
```bash
python launcher.py
```
インターフェースを使用してCSVファイルを選択し、処理オプションを設定してください。

### 2. コマンドラインでの実行
スクリプトを直接実行することも可能です。
```bash
python main.py filename next_flag
```
- `filename`: 処理するCSVファイルまたはTXTファイルを指定  
- `next_flag`: 最終来院日のフィルタリングに使用するタイムオフセット（-1, 0, 1のいずれか）を指定

---

## 設定

`config.py`を編集することでアプリケーションをカスタマイズできます。設定可能な項目は以下の通りです。

- 郵便番号、患者名、生年月日などの列名
- 小児患者を定義するための年齢閾値
- 出力先ファイルやNGリストのファイルパス
- リコール間隔

---

## データフォーマット

患者データのCSVファイルには、以下の列が含まれている必要があります（設定は`config.py`に基づきます）。

- 郵便番号
- 住所
- 患者名
- 生年月日: 存在しない場合、小児と成人の振り分けを行いません
- 最終来院日: 存在しない場合、すべての患者を対象にします
- 患者ID: 存在しない場合、NGリストを処理しません

---

## 開発およびテスト

`make_fake_list.py`を使用してテスト用のダミー患者データを生成できます。生成されたデータは`dummy_patient_data.csv`として保存されます。

---

## 謝辞

このプロジェクトでは、`Faker`（データ生成用）や`jusho`（住所処理用）などのライブラリを使用しています。依存関係の完全なリストは`requirements.txt`をご参照ください。

---

## ライセンス

このプロジェクトが配布されるライセンスを記載してください。
